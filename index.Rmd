---
title: "Gov 50 Final Project"
author: Althea Lee
description: "My final project"
output:
  distill::distill_article:
    self_contained: false
---

## Project thoughts

I am interested in exploring data about Singapore's socioeconomic classes and how it relates to willingness to vote for the opposition. 

Classified within political theory, Singapore can be identified as benevolent totalitarian, competitive authoritarian, or a de-facto one party state. Though the Singaporean government recognizing itself as a democratic country, reality of the political landscape argues differently. Election frameworks are skewed towards the ruling party's (PAP) victory, rampant censorship stymies civic education, restrictions and legislatures against public assembly erode collective action efforts, and government schemes entrench citizens in voting for the PAP. Moreover, measures such as v-dem and freedom house identify Singapore as undemocratic (0.4 on v-dem electoral democracy index and 47/100 on global freedom score). 

Much of Singapore's geographic and spatial distribution relies on socioeconomic class, primarily income from work. The country is divided into 5 different income classes: Upper class, Upper middle class, Intermediate middle class, Lower middle class, and Working class. 

I suspect that lower-class individuals are more willing to vote for the opposition for reasons twofold (demographic and psychographic). Firstly, lower-class voters have already experienced the short-end of the electoral stick in the form of institutional barriers: indebtedness from government housing schemes, a widening skills gap, and elitist career recruitment programs - all culminating towards low social mobility. Thus, animosity towards the ruling party may be a natural voting attitude. Secondly, lower-class voters tend to settle within constituencies where the opposition's victory has been long-standing. Residing in these constituencies are accompanied with the expectation that the opposition party will control quality of life within the area - a psychographic decision in value and political judgements. 

I believe that data analysis should exist in order to evaluate how much of Singapore's geographical distribution correlates to (and perhaps affects) an individual's political alignment. This can help us understand how landscape can be manipulated to tighten political reigns (i.e. ostracize political threats) and predict future voting outcomes in the next elections (2025). 

## Milestone 2

Does social class and area of residence influence voting patterns in Singapore’s general elections? For my final project, I intend to study whether social classes and constituencies share any trends with the results of the 2020 General Elections in Singapore. I hypothesize that in constituencies with lower-class residents, votes for the opposition will be greater. 

In constituencies with a greater proportion of lower-income individuals, fewer will be obliged to vote for the ruling party because they have experienced discriminatory policies such as in education and housing. 

In constituencies with a greater proportion of higher-income individuals, more will be obliged to vote for the ruling party because they house a greater percentage of elites who have a stake in the election results through private benefits such as institutionalized ties, tax refunds, policy decision making power, and more. 

My sample includes all electoral constituencies (31 in total) in the 2020 General Elections. 

My unit of analysis is Singapore’s General Election in 2020. 

The explanatory variable of interest is whether the ruling party or the opposition won in the constituency. This variable is coded =1 for the opposition’s victory and coded =0 for the ruling party’s victory. 

My outcome variable is the number of votes for the opposition. For instance, if the variable were coded =100, there were 100 votes for the opposition. 

If I observe a greater number of opposition votes in “lower-class” constituencies, then this would support my hypothesis.  However, if I observe a greater number of ruling party votes in “lower-class” constituencies, then this would provide evidence to reject my hypothesis. 

When I run my regression of the count of opposition party votes on the lower-class constituency variable, a positive, significant coefficient would support my hypothesis. 

The databases that will be used for this project include: 
- https://tablebuilder.singstat.gov.sg/table/CT/17571 (Gross Monthly Income from Work per PAR in 2020)
- https://data.gov.sg/dataset/parliamentary-general-election-results (2020 General Election Results)


## Milestone 3: Data visualization 

## Loading the general elections results dataset
```{r}
library(tidyverse)
library(readxl)

genel <- read_excel("~/Desktop/general elections dataset all years.xls")
```

## Loading the socioeconomic class dataset
```{r}
library(readxl)
socioec <- read_excel("~/Downloads/17571.xlsx")
```

In this dataset,Singapore's geographical regions are categorized by "Planning Area of Residence" (PAR). There are 55 PARs in Singapore. Each PAR is assigned to a constituency during the general elections. 

However, these electoral boundaries have been gerrymandered over Singapore's history by redrawing and dissolving. An example is the 1997 General Election where the PAP won by a close margin of 53,553 votes (54.8%) to the opposition with 44,132 votes (45.2%). After the elections, Cheng San GRC was dissolved in time for the next General Election in 2001. This is worth noting as this project investigates the 2020 elections which had a redrawing between Ang Mo Kio and Sengkang constituencies, where residents in two PARs (Fernvale and Jalan Kayu) were moved from Ang Mo Kio to Sengkang in 2010 and then back to Ang Mo Kio from the previous election in 2020. 

Therefore, the electoral boundaries may shift in the next General Election in 2025. Analyzing the socioeconomic groups that make up each constituency may also give insight into how the Singaporean government chooses to dissolve or redraw certain electoral boundaries due to changing value judgments or living standards in various socioeconomic groups. 

There are two types of constituencies: Group Representation Constituencies (GRCs) and Single-Member Constituencies (SMCs). An SMC is an electoral division with a single Member of Parliament (MP) running for office and representing residents of the entire constituency. Ergo, voters living in an SMC will vote for a single individual on the ballot. A GRC is an electoral division of larger geographical size and housing population. Multiple MPs represent residents in the constituency, and they must be of the same party. Voters residing in a GRC will vote for a group of individuals to be their MPs.

There are 31 constituencies in Singapore: 14 Single-Member Constituencies and 17 group representation constituencies.For instance, the voting constituency named "Aljunied" comprises of 5 PARS: Bedok Reservoir–Punggol, Eunos, Kaki Bukit, Paya Lebar, Serangoon. 

```{r}
genel2020 <- genel |> 
  filter(year == 2020) |> 
  select(constituency, constituency_type, party, vote_percentage)
```

```{r}
ge2020win <- genel2020 |> 
  mutate(vote_percentage = as.numeric(vote_percentage)) |> 
  mutate(Win = if_else(vote_percentage >= 0.5, "Yes", "No"))

ge2020win |> 
  select(constituency, party, vote_percentage)

bracket1 <- c("Ang Mo Kio", "Kebun Baru", "Bukit Batok", "Jurong", "Hong Kah North", "Bukit Merah", "Geylang", "MacPherson", "Jurong East", "Yuhua", "Jurong West", "Pioneer", "Outram", "Woodlands", "Sembawang", "Yishun", "Mountbatten", "Radin Mas", "Jalan Besar")

bracket2 <- c("Aljunied", "East Coast", "Bukit Panjang", "Chua Chu Kang", "Hougang", "Kallang", "Sembawang", "Sengkang", "Tampines", "Yio Chu Kang")

bracket3 <- c("Bishan-Toa Payoh","Potong Pasir", "Clementi", "Pasir Ris-Punggol", "Punggol West", "Queenstown", "Serangoon", "Marymount", "West Coast")

bracket4 <- c("Marine Parade", "Novena")

bracket5 <- c("Holland-Bukit Timah")

bracket6 <- c("Tanjong Pagar")
  

papwin <- ge2020win |> 
  filter(party == "PAP") |> 
  mutate(income_bracket = 0 ) |> 
  mutate(income_bracket = if_else(constituency%in%bracket1, 1, income_bracket)) |> 
  mutate(income_bracket = if_else(constituency%in%bracket2, 2, income_bracket)) |> 
  mutate(income_bracket = if_else(constituency%in%bracket3, 3, income_bracket)) |> 
  mutate(income_bracket = if_else(constituency%in%bracket4, 4, income_bracket)) |> 
  mutate(income_bracket = if_else(constituency%in%bracket5, 5, income_bracket)) |> 
  mutate(income_bracket = if_else(constituency%in%bracket6, 6, income_bracket)) |>
  mutate(income_bracket = na_if(income_bracket, 0)) |>
  select(constituency, vote_percentage, Win, income_bracket)
  

knitr::kable(papwin)


  
```

## Visualization 1
```{r}
ggplot(papwin, aes(x = constituency, y = vote_percentage)) + 
  geom_col(stat = "identity") + 
  theme(axis.text.x = element_text(angle =90, vjust =0.5, hjust =1)) +
  geom_hline(yintercept = 0.5, color = "cornflowerblue") + 
  labs(x ="Constituency", y = "Vote Percentage") 
```

## Visualization 2
```{r}
plot(papwin$income_bracket, papwin$vote_percentage)

ggplot(papwin,aes(x = income_bracket, y = vote_percentage)) + 
  geom_point() + 
  geom_smooth()
```

## Analysis of visualizations
Based on figure 1, there are 3 constituencies that fall under the 0.5 vote percentage cutoff, indicating that the PAP lost in 3 out of 31 constituencies. 

Looking to figure 2, we can observe that there is an inverted bell curve relationship between income bracket and vote percentage. The upper interval of the second income bracket is below the lower interval of the first income bracket, thus proving that the difference is statistically significant because it is outside of the interval. However, the confidence intervals of brackets 3, 4, 5, and 6 are overlapping, indicating that this difference is not statistically significant. 

## Analysis of income bracket and vote percentage
```{r}
l.lm <- lm(vote_percentage ~ income_bracket, data = papwin) 
summary(l.lm)

curve.lm <- lm(vote_percentage ~ income_bracket + I(income_bracket^2), data = papwin) 
summary(curve.lm)

```

The second test of curve.lm shows that there is a statistically significant effect between income bracket and vote percentage as seen with the p value less than 0.05. Furthermore, the adjusted R^2 value is approximately 17%, indicating that there is a positive correlation that is albeit weak. This may suggest that the middle-income brackets break the direct relationship and instead have the lowest turnout, rather than the low-income brackets. 

```{r}
library(sf)
singapore <- st_read("MP14_PLNG_AREA_WEB_PL.shp")
singapore <- singapore |> 
  mutate(conwin2 = tolower(PLN_AREA_N))
```

```{r}
papwin$conwin2 <- tolower(papwin$constituency)
```

```{r}
library(sf)
sgnew <- st_read("GRED_20190215_Singapore_2006.shp") 

sgnew <- sgnew |>
  mutate(cwin = tolower(cst_n))

sgnew

papwin$cwin <- tolower(papwin$constituency)
```


## Mapping Visualization
```{r}
newdata <- merge(singapore, papwin, by.x = "conwin2", by.y = "conwin2")

ggplot(newdata) +
 geom_sf(data = newdata, aes(fill = vote_percentage)) + 
  scale_fill_viridis_c(option = "H")
```

```{r}
newnewdata <- merge(sgnew, papwin, by.x = "cwin", by.y = "cwin")

ggplot(newnewdata) +
 geom_sf(data = newnewdata, aes(fill = vote_percentage)) + 
  scale_fill_viridis_c(option = "H")
```



